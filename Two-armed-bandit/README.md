
This folder contrains scripts for analyzing meta-in-context learning from LLMs on a two-armed bandit task using the analysis from [Gershman, 2018](https://pubmed.ncbi.nlm.nih.gov/29289795/)

# Running scripts:
## 1. query.py
The file which queries the two-armed bandit and stored the generated data in CSV files in the data folder. 

## 2. query_prior_expectations.py
The file which queries the LLM before a new task to get the prior expectations for the two-armed bandit. Also stores the generated data in CSV files in the data folder.

# 3. baselines_simulation.py
This files runs the baselines for the two-armed bandit task. The baselines are:
1. UCB
2. Thompson Sampling
3. Greedy

# Plotting scripts:
## 1. plot_regrets_acrosstrials.py
This file plots the regrets across trials for the LLM (Figure 3.A in the paper)

## 2. plot_regrets_acrossgames.py
This file plots the regrets across games for the LLM (Figure 3.B in the paper)

## 3. plot_regressions.py
This file plots the regressions onto regret and the reformulated probit regression from [Gershman, 2018](https://pubmed.ncbi.nlm.nih.gov/29289795/)
  for analyzing behaviour across games (Figures 3.C & 3.E in the paper).

  ## 4. plot_priors.py
This file plots the prior expectations for the LLM vs the True distribution in a swarmplot & violinplot (Figure 3.D in the paper).

## Directory Structure:
data/: Contains generated data stored in CSV files.

plots/: Contains plots generated by the plotting scripts.

envs/: Contains the two-armed bandit environment with the Kalman filter fitted to the behaviour of the agent's choice.